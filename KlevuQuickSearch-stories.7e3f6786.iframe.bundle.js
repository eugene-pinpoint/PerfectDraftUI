"use strict";(self.webpackChunkcomponent_library=self.webpackChunkcomponent_library||[]).push([[8262],{"./src/stories/KlevuQuickSearch.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Standard:()=>Standard,__namedExportsOrder:()=>__namedExportsOrder,default:()=>KlevuQuickSearch_stories});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),react=__webpack_require__("./node_modules/react/index.js"),mjs=__webpack_require__("./node_modules/@klevu/core/dist/mjs/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),makeStyles=__webpack_require__("./node_modules/@mui/styles/makeStyles/makeStyles.js"),clsx_m=__webpack_require__("./node_modules/clsx/dist/clsx.m.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),useStyles=(0,makeStyles.Z)((function styles(theme){return{wrapper:(0,defineProperty.Z)({position:"absolute",width:"500px",borderRadius:"5px",border:"1px solid #ccc",boxShadow:"0px 4px 13px 0px rgba(0, 0, 0, 0.1)",marginTop:"10px",display:"grid",gridTemplateColumns:"2fr 5fr"},theme.breakpoints.down(500),{width:"400px",gridTemplateColumns:"1fr"}),heading:{fontWeight:600,color:"#647380",marginBottom:"5px"},popular:{backgroundColor:"#F9FAFB",padding:"10px"},trending:{padding:"10px"},products:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)"},product:{display:"block",padding:"5px","&:hover p":{color:"#48c0be"}},productName:{fontSize:"12px",lineHeight:"1.25em",marginTop:"10px"}}}),{name:"KlevuTrendingProductsPanel"}),TrendingProductsPanel=function TrendingProductsPanel(_ref){var className=_ref.className,classes=_ref.classes,searchUrl=_ref.searchUrl;classes=useStyles({classes});var _useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),popularTerms=_useState2[0],setPopularTerms=_useState2[1],_useState3=(0,react.useState)([]),_useState4=(0,slicedToArray.Z)(_useState3,2),products=_useState4[0],setProducts=_useState4[1],fetchPopularTerms=function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var settings;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,mjs.KX)();case 2:settings=_context.sent,setPopularTerms(settings.root.klevu_webstorePopularTerms);case 4:case"end":return _context.stop()}}),_callee)})));return function fetchPopularTerms(){return _ref2.apply(this,arguments)}}(),fetchTrendingProducts=function(){var _ref3=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var result;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,(0,mjs.oz)((0,mjs.V6)({limit:3}));case 2:result=_context2.sent,setProducts(result.apiResponse.queryResults.at(0).records);case 4:case"end":return _context2.stop()}}),_callee2)})));return function fetchTrendingProducts(){return _ref3.apply(this,arguments)}}();return(0,react.useEffect)((function(){fetchPopularTerms().catch(console.error),fetchTrendingProducts().catch(console.error)}),[]),(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.Z)(classes.wrapper,className),children:[(0,jsx_runtime.jsxs)("div",{className:classes.popular,children:[(0,jsx_runtime.jsx)("p",{className:classes.heading,children:"Popular"}),(0,jsx_runtime.jsx)("div",{children:popularTerms&&popularTerms.map((function(term){return(0,jsx_runtime.jsx)("a",{href:searchUrl.replace("%QUERY%",term),children:term},term)}))})]}),(0,jsx_runtime.jsxs)("div",{className:classes.trending,children:[(0,jsx_runtime.jsx)("p",{className:classes.heading,children:"Trending"}),(0,jsx_runtime.jsx)("div",{className:classes.products,children:products.map((function(product){return(0,jsx_runtime.jsxs)("a",{href:product.url,className:classes.product,children:[(0,jsx_runtime.jsx)("img",{src:product.image}),(0,jsx_runtime.jsx)("p",{className:classes.productName,children:product.name})]},product.id)}))})]})]})};TrendingProductsPanel.displayName="TrendingProductsPanel",TrendingProductsPanel.propTypes={className:prop_types_default().string,classes:prop_types_default().array,searchUrl:prop_types_default().string},TrendingProductsPanel.__docgenInfo={description:"",methods:[],displayName:"TrendingProductsPanel",props:{className:{description:"",type:{name:"string"},required:!1},classes:{description:"",type:{name:"array"},required:!1},searchUrl:{description:"",type:{name:"string"},required:!1}}};const klevu_TrendingProductsPanel=TrendingProductsPanel;var QuickSearchResultsPanel_useStyles=(0,makeStyles.Z)((function styles(){return{wrapper:{position:"absolute",width:"400px",borderRadius:"5px",border:"1px solid #ccc",boxShadow:"0px 4px 13px 0px rgba(0, 0, 0, 0.1)",marginTop:"10px"},section:{padding:"10px","&:not(:last-child)":{borderBottom:"1px solid #ccc"}},heading:{marginBottom:"10px",fontWeight:600,color:"#647380"},productHeadings:{display:"flex"},viewAll:{marginLeft:"auto",color:"#48c0be","&:hover, &:visited":{color:"#48c0be"}},suggestion:{margin:"5px 0"},category:{margin:"4px 0"},product:{display:"flex",marginBottom:"10px","&:last-of-type":{marginBottom:"8px"},"&:hover":{textDecoration:"none"},"&:hover .product__name":{color:"#48c0be",textDecoration:"underline"}},productImage:{maxWidth:"50px"},productInfo:{marginLeft:"10px",display:"flex",flexDirection:"column",justifyContent:"center"},productInfoText:{margin:0},productInfoPrice:{fontWeight:600},noResults:{textAlign:"center",padding:"15px 10px"},noResultsText:{fontWeight:600,color:"#647380"}}}),{name:"KlevuSearchResultsPanel"}),QuickSearchResultsPanel=function QuickSearchResultsPanel(_ref){var className=_ref.className,classes=_ref.classes,searchUrl=_ref.searchUrl,searchTerm=_ref.searchTerm;classes=QuickSearchResultsPanel_useStyles({classes});var _useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),suggestions=_useState2[0],setSuggestions=_useState2[1],_useState3=(0,react.useState)([]),_useState4=(0,slicedToArray.Z)(_useState3,2),categories=_useState4[0],setCategories=_useState4[1],_useState5=(0,react.useState)([]),_useState6=(0,slicedToArray.Z)(_useState5,2),products=_useState6[0],setProducts=_useState6[1],fetchSuggestions=function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var suggestionsResult;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,mjs.oz)((0,mjs.tJ)(searchTerm,{limit:4}));case 2:suggestionsResult=_context.sent,setSuggestions(suggestionsResult.apiResponse.suggestionResults.at(0).suggestions);case 4:case"end":return _context.stop()}}),_callee)})));return function fetchSuggestions(){return _ref2.apply(this,arguments)}}(),fetchCategories=function(){var _ref3=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var categoriesResult;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,(0,mjs.oz)((0,mjs.yC)(searchTerm,{limit:4,typeOfRecords:[mjs.kQ.Category]}));case 2:categoriesResult=_context2.sent,setCategories(categoriesResult.apiResponse.queryResults.at(0).records);case 4:case"end":return _context2.stop()}}),_callee2)})));return function fetchCategories(){return _ref3.apply(this,arguments)}}(),fetchProducts=function(){var _ref4=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee3(){var productsResult;return regenerator_default().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,(0,mjs.oz)((0,mjs.yC)(searchTerm,{limit:4,typeOfRecords:[mjs.kQ.Product]}));case 2:productsResult=_context3.sent,setProducts(productsResult.apiResponse.queryResults.at(0).records);case 4:case"end":return _context3.stop()}}),_callee3)})));return function fetchProducts(){return _ref4.apply(this,arguments)}}();return(0,react.useEffect)((function(){fetchSuggestions().catch(console.error),fetchCategories().catch(console.error),fetchProducts().catch(console.error)}),[searchTerm]),(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.Z)(classes.wrapper,className),children:[suggestions.length>0&&(0,jsx_runtime.jsxs)("div",{className:classes.section,children:[(0,jsx_runtime.jsx)("p",{className:classes.heading,children:"Suggestions"}),suggestions.map((function(suggestion){return(0,jsx_runtime.jsx)("div",{className:classes.suggestion,children:(0,jsx_runtime.jsx)("a",{href:searchUrl.replace("%QUERY%",suggestion.suggest),dangerouslySetInnerHTML:{__html:suggestion.suggest}})},suggestion.suggest)}))]}),categories.length>0&&(0,jsx_runtime.jsxs)("div",{className:classes.section,children:[(0,jsx_runtime.jsx)("p",{className:classes.heading,children:"Category"}),categories.map((function(category){return(0,jsx_runtime.jsx)("div",{className:classes.category,children:(0,jsx_runtime.jsx)("a",{href:category.url,children:category.name})},category.id)}))]}),products.length>0&&(0,jsx_runtime.jsxs)("div",{className:classes.section,children:[(0,jsx_runtime.jsxs)("div",{className:classes.productHeadings,children:[(0,jsx_runtime.jsx)("p",{className:classes.heading,children:"Products"}),(0,jsx_runtime.jsx)("a",{href:searchUrl.replace("%QUERY%",searchTerm),className:classes.viewAll,children:"View All"})]}),products.map((function(product){return(0,jsx_runtime.jsxs)("a",{href:product.url,className:classes.product,children:[(0,jsx_runtime.jsx)("img",{className:classes.productImage,src:product.image}),(0,jsx_runtime.jsxs)("div",{className:classes.productInfo,children:[(0,jsx_runtime.jsx)("p",{className:(0,clsx_m.Z)(classes.productInfoText,"product__name"),children:product.name}),(0,jsx_runtime.jsxs)("p",{className:(0,clsx_m.Z)(classes.productInfoText,classes.productInfoPrice),children:["£",product.price]})]})]},product.id)}))]}),0===suggestions.length&&0===categories.length&&0===products.length&&(0,jsx_runtime.jsx)("div",{className:classes.noResults,children:(0,jsx_runtime.jsx)("p",{className:classes.noResultsText,children:"No results found"})})]})};QuickSearchResultsPanel.displayName="QuickSearchResultsPanel",QuickSearchResultsPanel.propTypes={className:prop_types_default().string,classes:prop_types_default().array,searchUrl:prop_types_default().string,searchTerm:prop_types_default().string},QuickSearchResultsPanel.__docgenInfo={description:"",methods:[],displayName:"QuickSearchResultsPanel",props:{className:{description:"",type:{name:"string"},required:!1},classes:{description:"",type:{name:"array"},required:!1},searchUrl:{description:"",type:{name:"string"},required:!1},searchTerm:{description:"",type:{name:"string"},required:!1}}};const klevu_QuickSearchResultsPanel=QuickSearchResultsPanel;var QuickSearch_useStyles=(0,makeStyles.Z)((function styles(){return{wrapper:{display:"inline-block"},inputWrapper:{display:"inline-block",position:"relative","&::after":{display:"block",content:'""',height:"20px",width:"20px",position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",backgroundSize:"cover"}},input:{width:"400px",borderRadius:"5px",appearance:"none"}}}),{name:"KlevuQuickSearch"}),QuickSearch=function QuickSearch(_ref){var className=_ref.className,classes=_ref.classes,searchUrl=_ref.searchUrl;classes=QuickSearch_useStyles({classes});var _useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),active=_useState2[0],setActive=_useState2[1],_useState3=(0,react.useState)(""),_useState4=(0,slicedToArray.Z)(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1],wrapperRef=(0,react.useRef)(null),inputRef=(0,react.useRef)(null);return(0,react.useEffect)((function(){window.addEventListener("click",(function(e){return setActive(wrapperRef.current.contains(e.target))}))}),[]),(0,jsx_runtime.jsxs)("div",{ref:wrapperRef,className:(0,clsx_m.Z)(className,classes.wrapper),children:[(0,jsx_runtime.jsx)("div",{className:classes.inputWrapper,children:(0,jsx_runtime.jsx)("input",{ref:inputRef,type:"text",className:classes.input,onFocus:function onFocus(){return setActive(!0)},onChange:function handleUpdate(){return setSearchTerm(inputRef.current.value)}})}),active&&!searchTerm&&(0,jsx_runtime.jsx)(klevu_TrendingProductsPanel,{searchUrl}),active&&searchTerm&&(0,jsx_runtime.jsx)(klevu_QuickSearchResultsPanel,{searchUrl,searchTerm})]})};QuickSearch.displayName="QuickSearch",QuickSearch.propTypes={className:prop_types_default().string,classes:prop_types_default().array,searchUrl:prop_types_default().string},QuickSearch.defaultProps={searchUrl:"https://bigcommerce-pwa.mybigcommerce.com/search.php?search_query=%QUERY%"},QuickSearch.__docgenInfo={description:"",methods:[],displayName:"QuickSearch",props:{searchUrl:{defaultValue:{value:"'https://bigcommerce-pwa.mybigcommerce.com/search.php?search_query=%QUERY%'",computed:!1},description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},classes:{description:"",type:{name:"array"},required:!1}}};const klevu_QuickSearch=QuickSearch;var _Standard$parameters,_Standard$parameters2;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const KlevuQuickSearch_stories={parameters:{storySource:{source:"import React from 'react';\nimport { KlevuConfig } from '@klevu/core';\nimport QuickSearch from '../klevu/QuickSearch';\nexport default {\n  title: 'KlevuQuickSearch',\n  component: QuickSearch,\n  argTypes: {\n    searchUrl: {\n      control: {\n        type: 'text'\n      },\n      description: 'The search URL to be used by the QuickSearch component'\n    }\n  }\n};\nKlevuConfig.init({\n  url: process.env.STORYBOOK_KLEVU_URL,\n  apiKey: process.env.STORYBOOK_KLEVU_API_KEY\n});\nconst Template = args => <QuickSearch {...args} />;\nexport const Standard = Template.bind({});\nStandard.args = {};\nStandard.parameters = {\n  ...Standard.parameters,\n  docs: {\n    ...Standard.parameters?.docs,\n    source: {\n      originalSource: \"args => <QuickSearch {...args} />\",\n      ...Standard.parameters?.docs?.source\n    }\n  }\n};",locationsMap:{standard:{startLoc:{col:17,line:20},endLoc:{col:50,line:20},startBody:{col:17,line:20},endBody:{col:50,line:20}}}}},title:"KlevuQuickSearch",component:klevu_QuickSearch,argTypes:{searchUrl:{control:{type:"text"},description:"The search URL to be used by the QuickSearch component"}}};mjs.j9.init({url:"https://eucs32v2.ksearchnet.com/cs/v2/search",apiKey:"klevu-168621359365416452"});var Template=function Template(args){return(0,jsx_runtime.jsx)(klevu_QuickSearch,_objectSpread({},args))};Template.displayName="Template";var Standard=Template.bind({});Standard.args={},Standard.parameters=_objectSpread(_objectSpread({},Standard.parameters),{},{docs:_objectSpread(_objectSpread({},null===(_Standard$parameters=Standard.parameters)||void 0===_Standard$parameters?void 0:_Standard$parameters.docs),{},{source:_objectSpread({originalSource:"args => <QuickSearch {...args} />"},null===(_Standard$parameters2=Standard.parameters)||void 0===_Standard$parameters2||null===(_Standard$parameters2=_Standard$parameters2.docs)||void 0===_Standard$parameters2?void 0:_Standard$parameters2.source)})});var __namedExportsOrder=["Standard"]}}]);