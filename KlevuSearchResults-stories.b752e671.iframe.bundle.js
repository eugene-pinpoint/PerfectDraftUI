"use strict";(self.webpackChunkcomponent_library=self.webpackChunkcomponent_library||[]).push([[3123],{"./src/stories/KlevuSearchResults.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,default:()=>KlevuSearchResults_stories,standard:()=>standard});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),mjs=__webpack_require__("./node_modules/@klevu/core/dist/mjs/index.js"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),makeStyles=__webpack_require__("./node_modules/@mui/styles/makeStyles/makeStyles.js"),clsx_m=__webpack_require__("./node_modules/clsx/dist/clsx.m.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),useStyles=(0,makeStyles.Z)((function styles(){return{sku:{margin:"0 0 5px 0",color:"#888",fontSize:"13px"},price:{borderTop:"1px solid #ccc",padding:"8px 0",fontWeight:700},priceText:{fontWeight:400,textTransform:"uppercase",fontSize:"12px",color:"#888"},priceOriginal:{fontWeight:400,color:"#888"},priceSale:{marginLeft:"8px",color:"#48c0be"}}}),{name:"KlevuSearchResultProduct"}),Product=function Product(_ref){var className=_ref.className,classes=_ref.classes,product=_ref.product;classes=useStyles({classes});var formatPrice=function formatPrice(price){return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(price)};return(0,jsx_runtime.jsxs)("div",{className,children:[(0,jsx_runtime.jsx)("a",{href:product.url,children:(0,jsx_runtime.jsx)("img",{src:product.image})}),(0,jsx_runtime.jsx)("a",{href:product.url,children:product.name}),(0,jsx_runtime.jsxs)("p",{className:classes.sku,children:["SKU: ",product.sku]}),Number(product.price)===Number(product.basePrice)&&(0,jsx_runtime.jsxs)("p",{className:classes.price,children:[(0,jsx_runtime.jsx)("span",{className:classes.priceText,children:product.totalVariants>0&&"As low as: "}),(0,jsx_runtime.jsx)("span",{children:formatPrice(product.basePrice)})]}),Number(product.price)!==Number(product.basePrice)&&(0,jsx_runtime.jsxs)("p",{className:classes.price,children:[(0,jsx_runtime.jsx)("span",{className:classes.priceOriginal,children:(0,jsx_runtime.jsx)("strike",{children:formatPrice(product.price)})}),(0,jsx_runtime.jsx)("span",{className:classes.priceSale,children:formatPrice(product.basePrice)})]})]},product.id)};Product.displayName="Product",Product.propTypes={},Product.__docgenInfo={description:"",methods:[],displayName:"Product"};const SearchResults_Product=Product;var Grid_useStyles=(0,makeStyles.Z)((function styles(){return{wrapper:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"20px",marginTop:"20px"}}}),{name:"KlevuSearchResultProductGrid"}),Grid=function Grid(_ref){var className=_ref.className,classes=_ref.classes,products=_ref.products;return classes=Grid_useStyles({classes}),(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.Z)(className,classes.wrapper),children:products.map((function(product){return(0,jsx_runtime.jsx)(SearchResults_Product,{product},product.id)}))})};Grid.displayName="Grid",Grid.propTypes={},Grid.__docgenInfo={description:"",methods:[],displayName:"Grid"};const Product_Grid=Grid;var Option_useStyles=(0,makeStyles.Z)((function styles(){return{wrapper:{display:"flex",cursor:"pointer",margin:"5px 0",columnGap:"10px"},checkbox:{display:"block",width:"20px",height:"20px",border:"1px solid #ccc",borderRadius:"5px",boxShadow:"0px 1px 3px 0px rgba(0, 0, 0, 0.1)"},activeCheckbox:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' version='1.1'%3E%3Cg id='surface1'%3E%3Cpath d='M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z '/%3E%3C/g%3E%3C/svg%3E%0A\")",backgroundSize:"75%",backgroundPosition:"center",backgroundRepeat:"no-repeat"},inactiveCheckbox:{},activeText:{fontWeight:"700"},inactiveText:{}}}),{name:"KlevuSearchResultOption"}),Options=function Options(_ref){var className=_ref.className,classes=_ref.classes,filterManager=_ref.filterManager,filter=_ref.filter,option=_ref.option;classes=Option_useStyles({classes});var _useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),active=_useState2[0],setActive=_useState2[1];return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.Z)(className,classes.wrapper),onClick:function onClick(){return function handleOptionClick(optionName){setActive(!active),filterManager.toggleOption(filter.key,optionName)}(option.name)},children:[active&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.Z)(classes.checkbox,classes.activeCheckbox)}),(0,jsx_runtime.jsxs)("p",{className:classes.activeText,children:[option.value," (",option.count,")"]})]}),!active&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.Z)(classes.checkbox,classes.inactiveCheckbox)}),(0,jsx_runtime.jsxs)("p",{className:classes.inactiveText,children:[option.value," (",option.count,")"]})]})]})};Options.displayName="Options",Options.propTypes={},Options.__docgenInfo={description:"",methods:[],displayName:"Options"};const Option=Options;var Options_useStyles=(0,makeStyles.Z)((function styles(){return{}}),{name:"KlevuSearchResultOptions"}),Options_Options=function Options(_ref){var className=_ref.className,classes=_ref.classes,filterManager=_ref.filterManager,filter=_ref.filter,options=_ref.options;return classes=Options_useStyles({classes}),(0,jsx_runtime.jsx)("div",{className,children:options.map((function(option){return(0,jsx_runtime.jsx)(Option,{filterManager,filter,option},option.name)}))})};Options_Options.displayName="Options",Options_Options.propTypes={},Options_Options.__docgenInfo={description:"",methods:[],displayName:"Options"};const Filter_Options=Options_Options;var Slider_Slider=__webpack_require__("./node_modules/@mui/material/Slider/Slider.js"),Slider_useStyles=(0,makeStyles.Z)((function styles(){return{}}),{name:"KlevuSearchResultSlider"}),Slider=function Slider(_ref){var className=_ref.className,classes=_ref.classes,filter=(_ref.filterManager,_ref.filter);classes=Slider_useStyles({classes});var _useState=(0,react.useState)([filter.min,filter.max]),_useState2=(0,slicedToArray.Z)(_useState,2),value=_useState2[0],setValue=_useState2[1];return(0,jsx_runtime.jsx)("div",{className,children:(0,jsx_runtime.jsx)(Slider_Slider.ZP,{getAriaLabel:function getAriaLabel(){return"Range"},value,onChange:function onChange(e,val){return setValue(val)},valueLabelDisplay:"auto",getAriaValueText:function getAriaValueText(){return value},"aria-label":"Default",min:0,max:filter.max})})};Slider.displayName="Slider",Slider.propTypes={},Slider.__docgenInfo={description:"",methods:[],displayName:"Slider"};const Filter_Slider=Slider;var Filter_useStyles=(0,makeStyles.Z)((function styles(){return{filter:{borderTop:"1px solid #ccc",padding:"10px","&:last-child":{borderBottom:"1px solid #ccc"}},header:{display:"flex",cursor:"pointer"},heading:{textTransform:"capitalize",fontWeight:"700",marginBottom:"0"},iconWrapper:{marginLeft:"auto"},icon:{height:"18px"},collapsedContent:{display:"none"},fullContent:{marginTop:"15px"}}}),{name:"KlevuSearchResultFilter"}),Filter=function Filter(_ref){var className=_ref.className,classes=_ref.classes,filterManager=_ref.filterManager,filter=_ref.filter;classes=Filter_useStyles({classes});var _useState=(0,react.useState)(!0),_useState2=(0,slicedToArray.Z)(_useState,2),collapsed=_useState2[0],setCollapsed=_useState2[1];return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.Z)(className,classes.filter),children:[(0,jsx_runtime.jsx)("div",{className:classes.header,onClick:function onClick(){return setCollapsed(!collapsed)},children:(0,jsx_runtime.jsx)("p",{className:classes.heading,children:filter.label})}),(0,jsx_runtime.jsxs)("div",{className:collapsed?classes.collapsedContent:classes.fullContent,children:[filter.type===mjs.kw.Options&&(0,jsx_runtime.jsx)(Filter_Options,{filterManager,filter,options:filter.options}),filter.type===mjs.kw.Slider&&(0,jsx_runtime.jsx)(Filter_Slider,{filterManager,filter})]})]})};Filter.displayName="Filter",Filter.propTypes={},Filter.__docgenInfo={description:"",methods:[],displayName:"Filter"};const Filters_Filter=Filter;var Filters_useStyles=(0,makeStyles.Z)((function styles(){return{wrapper:{marginTop:"55px"}}}),{name:"KlevuSearchResultFilters"}),Filters=function Filters(_ref){var className=_ref.className,classes=_ref.classes,filterManager=_ref.filterManager;return classes=Filters_useStyles({classes}),(0,jsx_runtime.jsx)("div",{className:(0,clsx_m.Z)(className,classes.wrapper),children:filterManager.filters.map((function(filter){return(0,jsx_runtime.jsx)(Filters_Filter,{filterManager,filter},filter.key)}))})};Filters.displayName="Filters",Filters.propTypes={},Filters.__docgenInfo={description:"",methods:[],displayName:"Filters"};const SearchResults_Filters=Filters;var ShowMore_useStyles=(0,makeStyles.Z)((function styles(){return{button:{display:"inline-block",padding:"0.5em 1.5em",backgroundColor:"#48c0be",color:"#fff",borderRadius:"5px",cursor:"pointer","&:hover":{color:"#fff",textDecoration:"none"}}}}),{name:"KlevuSearchResultShowMore"}),ShowMore=function ShowMore(_ref){var className=_ref.className,classes=_ref.classes,showMoreHandler=_ref.showMoreHandler;return classes=ShowMore_useStyles({classes}),(0,jsx_runtime.jsx)("a",{className:(0,clsx_m.Z)(className,classes.button),onClick:showMoreHandler,children:"Show More"})};ShowMore.displayName="ShowMore",ShowMore.propTypes={},ShowMore.__docgenInfo={description:"",methods:[],displayName:"ShowMore"};const SearchResults_ShowMore=ShowMore;var Toolbar_useStyles=(0,makeStyles.Z)((function styles(){return{wrapper:{display:"flex"},resultCount:{margin:"auto 0",fontSize:"13px"},sortBy:{display:"flex",marginLeft:"auto",border:"1px solid #ccc",borderRadius:"5px",padding:"6px 15px"},sortByText:{flexShrink:0,margin:"auto 0",fontSize:"13px",color:"#888"},sortBySelect:{width:"140px",padding:0,marginLeft:"5px",fontSize:"13px",color:"#888",backgroundPosition:"center right 0",backgroundSize:"12px","&, &:hover, &:focus":{appearance:"none",border:"none",boxShadow:"none"}}}}),{name:"KlevuSearchResultToolbar"}),Toolbar=function Toolbar(_ref){var className=_ref.className,classes=_ref.classes,resultsFound=_ref.resultsFound,sortByHandler=_ref.sortByHandler;classes=Toolbar_useStyles({classes});var sortByRef=(0,react.useRef)(null);return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.Z)(className,classes.wrapper),children:[null!==resultsFound&&(0,jsx_runtime.jsxs)("p",{className:classes.resultCount,children:[resultsFound," Result",1!==resultsFound&&"s"]}),(0,jsx_runtime.jsxs)("div",{className:classes.sortBy,children:[(0,jsx_runtime.jsx)("p",{className:classes.sortByText,children:"Sort by:"}),(0,jsx_runtime.jsxs)("select",{className:classes.sortBySelect,ref:sortByRef,onChange:function handleSortByChange(){sortByHandler(sortByRef.current.value)},children:[(0,jsx_runtime.jsx)("option",{value:mjs._U.Relevance,children:"Relevance"}),(0,jsx_runtime.jsx)("option",{value:mjs._U.PriceAsc,children:"Price - Low to High"}),(0,jsx_runtime.jsx)("option",{value:mjs._U.PriceDesc,children:"Price - High to Low"})]})]})]})};Toolbar.displayName="Toolbar",Toolbar.propTypes={},Toolbar.__docgenInfo={description:"",methods:[],displayName:"Toolbar"};const SearchResults_Toolbar=Toolbar;var nextFunc,SearchResults_useStyles=(0,makeStyles.Z)((function styles(){return{wrapper:{display:"grid",columnGap:"20px",gridTemplateColumns:"2fr 5fr"}}}),{name:"KlevuSearchResults"}),filterManager=new mjs.En,SearchResults=function SearchResults(_ref){var className=_ref.className,classes=_ref.classes,searchTerm=_ref.searchTerm;classes=SearchResults_useStyles({classes});var _useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),resultsFound=_useState2[0],setResultsFound=_useState2[1],_useState3=(0,react.useState)([]),_useState4=(0,slicedToArray.Z)(_useState3,2),products=_useState4[0],setProducts=_useState4[1],_useState5=(0,react.useState)(mjs._U.Relevance),_useState6=(0,slicedToArray.Z)(_useState5,2),sorting=_useState6[0],setSorting=_useState6[1],_useState7=(0,react.useState)(!1),_useState8=(0,slicedToArray.Z)(_useState7,2),showMore=_useState8[0],setShowMore=_useState8[1],fetch=(0,react.useCallback)((0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var _searchResult$records,modifiers,functions,res,searchResult;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return modifiers=[(0,mjs.M4)({include:["category"],rangeFilterSettings:[{key:"klevu_price",minMax:!0}],filterManager}),(0,mjs.cl)(filterManager),(0,mjs.hQ)()],functions=[mjs.yC.apply(void 0,[searchTerm,{id:"search",limit:8,sort:sorting}].concat(modifiers))],_context.next=4,mjs.oz.apply(void 0,functions);case 4:if(res=_context.sent,searchResult=res.queriesById("search")){_context.next=8;break}return _context.abrupt("return");case 8:setResultsFound(searchResult.meta.totalResultsFound),setProducts(null!==(_searchResult$records=searchResult.records)&&void 0!==_searchResult$records?_searchResult$records:[]),setShowMore(!!searchResult.next),nextFunc=searchResult.next;case 12:case"end":return _context.stop()}}),_callee)}))),[sorting,searchTerm]),fetchMore=function(){var _ref3=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var _searchResult$records2,nextRes,searchResult;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,nextFunc({filterManager});case 2:if(nextRes=_context2.sent,searchResult=nextRes.queriesById("search")){_context2.next=6;break}return _context2.abrupt("return");case 6:setProducts([].concat((0,toConsumableArray.Z)(products),(0,toConsumableArray.Z)(null!==(_searchResult$records2=searchResult.records)&&void 0!==_searchResult$records2?_searchResult$records2:[]))),setShowMore(!!searchResult.next),nextFunc=searchResult.next;case 9:case"end":return _context2.stop()}}),_callee2)})));return function fetchMore(){return _ref3.apply(this,arguments)}}();(0,react.useEffect)((function(){var stop=(0,mjs.eo)(mjs.Bt.FilterSelectionUpdate,fetch);return function(){stop()}}),[sorting,searchTerm]),(0,react.useEffect)((function(){fetch().catch(console.error)}),[sorting,searchTerm]);return(0,jsx_runtime.jsxs)("div",{className:(0,clsx_m.Z)(className,classes.wrapper),children:[(0,jsx_runtime.jsx)(SearchResults_Filters,{filterManager}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(SearchResults_Toolbar,{resultsFound,sortByHandler:function handleSortByChange(value){return setSorting(value)}}),(0,jsx_runtime.jsx)(Product_Grid,{products}),showMore&&(0,jsx_runtime.jsx)(SearchResults_ShowMore,{showMoreHandler:fetchMore})]})]})};SearchResults.displayName="SearchResults",SearchResults.propTypes={},SearchResults.__docgenInfo={description:"",methods:[],displayName:"SearchResults"};const klevu_SearchResults=SearchResults;var _standard$parameters,_standard$parameters2;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}mjs.j9.init({url:"https://eucs32v2.ksearchnet.com/cs/v2/search",apiKey:"klevu-168621359365416452"});var standard=function standard(){var _useState=(0,react.useState)(""),_useState2=(0,slicedToArray.Z)(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1],inputRef=(0,react.useRef)(null);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("input",{ref:inputRef,placeholder:"Input for testing in Storybook...",onChange:function handleInputChange(){setSearchTerm(inputRef.current.value)}}),(0,jsx_runtime.jsx)(klevu_SearchResults,{searchTerm})]})};const KlevuSearchResults_stories={parameters:{storySource:{source:"import React, { useState, useRef } from 'react';\nimport { KlevuConfig } from '@klevu/core';\nimport SearchResults from '../klevu/SearchResults';\nKlevuConfig.init({\n  url: process.env.STORYBOOK_KLEVU_URL,\n  apiKey: process.env.STORYBOOK_KLEVU_API_KEY\n});\nexport const standard = () => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const inputRef = useRef(null);\n  const handleInputChange = () => {\n    setSearchTerm(inputRef.current.value);\n  };\n  return <>\n      <input ref={inputRef} placeholder=\"Input for testing in Storybook...\" onChange={handleInputChange} />\n      <SearchResults searchTerm={searchTerm} />\n    </>;\n};\nexport default {\n  title: 'KlevuSearchResults'\n};\nstandard.parameters = {\n  ...standard.parameters,\n  docs: {\n    ...standard.parameters?.docs,\n    source: {\n      originalSource: \"() => {\\n  const [searchTerm, setSearchTerm] = useState('');\\n  const inputRef = useRef(null);\\n  const handleInputChange = () => {\\n    setSearchTerm(inputRef.current.value);\\n  };\\n  return <>\\n      <input ref={inputRef} placeholder=\\\"Input for testing in Storybook...\\\" onChange={handleInputChange} />\\n      <SearchResults searchTerm={searchTerm} />\\n    </>;\\n}\",\n      ...standard.parameters?.docs?.source\n    }\n  }\n};",locationsMap:{standard:{startLoc:{col:24,line:8},endLoc:{col:1,line:18},startBody:{col:24,line:8},endBody:{col:1,line:18}}}}},title:"KlevuSearchResults"};standard.parameters=_objectSpread(_objectSpread({},standard.parameters),{},{docs:_objectSpread(_objectSpread({},null===(_standard$parameters=standard.parameters)||void 0===_standard$parameters?void 0:_standard$parameters.docs),{},{source:_objectSpread({originalSource:"() => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const inputRef = useRef(null);\n  const handleInputChange = () => {\n    setSearchTerm(inputRef.current.value);\n  };\n  return <>\n      <input ref={inputRef} placeholder=\"Input for testing in Storybook...\" onChange={handleInputChange} />\n      <SearchResults searchTerm={searchTerm} />\n    </>;\n}"},null===(_standard$parameters2=standard.parameters)||void 0===_standard$parameters2||null===(_standard$parameters2=_standard$parameters2.docs)||void 0===_standard$parameters2?void 0:_standard$parameters2.source)})});var __namedExportsOrder=["standard"];standard.__docgenInfo={description:"",methods:[],displayName:"standard"}}}]);